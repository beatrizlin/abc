<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" />
</head>
<body>
    <ul class="nav nav-pills">
        <li role="presentation" class="active"><a href="#GetProducts" data-toggle="tab">查詢</a></li>
        <li role="presentation"><a href="#InsertProducts" data-toggle="tab">新增</a></li>
        <li role="presentation"><a href="#UpdateProducts" data-toggle="tab">修改</a></li>
        <li role="presentation"><a href="#DeleteProducts" data-toggle="tab">刪除</a></li>
    </ul>
    <div class="tab-content" style="padding:20px">
        <div id="GetProducts" class="tab-pane fade in active">
            所有商品
            <button id="QueryProduct" onclick="QueryProducts()">查詢</button>
            <div id="Products"></div>
        </div>
        <div id="InsertProducts" class="tab-pane fade">
            新增商品
            <div class="container">
                <div class="form-group">
                    <label for="insertTitle">Title</label>
                    <input id="insertTitle" class="form-control" />
                </div>
                <div class="form-group">
                    <label for="insertPrice">Price</label>
                    <input id="insertPrice" class="form-control" />
                </div>
                <div class="form-group">
                    <label for="insertInstock">Instock</label>
                    <input id="insertInstock" class="form-control" />
                </div>
                <div class="form-group">
                    <button onclick="InsertProducts()">新增</button>
                </div>
            </div>
        </div>
        <div id="UpdateProducts" class="tab-pane fade">
            修改商品
            <div class="container">
                <div class="form-group">
                    <label for="updateTitle">Title</label>
                    <input id="updateTitle" class="form-control" />
                </div>
                <div class="form-group">
                    <label for="updatePrice">Price</label>
                    <input id="updatePrice" class="form-control" />
                </div>
                <div class="form-group">
                    <label for="updateInstock">Instock</label>
                    <input id="updateInstock" class="form-control" />
                </div>
                <div class="form-group">
                    <button onclick="UpdateProducts()">修改</button>
                </div>
            </div>
        </div>
        <div id="DeleteProducts" class="tab-pane fade">
            刪除商品
            <div class="container">
                <div class="form-group">
                    <label for="deleteTitle">Title</label>
                    <input id="deleteTitle" class="form-control" />
                </div>
                <div class="form-group">
                    <button onclick="DeleteProducts()">刪除</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        function QueryProducts() {
            $.ajax({
                type: "GET",
                url: "http://localhost:1337/api/products",
            }).done(function (products) {
                //alert(JSON.stringify(products));
                var str = "";
                str += "<table class='table table-striped table-hover'>";
                str += "<thead>";
                str += "<tr>";
                str += "<td>title</td>";
                str += "<td>price</td>";
                str += " <td>instock</td>";
                str += "</tr>";
                str += "</thead>";
                str += "<tbody>";
                $.each(products, function (index, product) {
                    str += "<tr>";
                    str += "<td>" + product.title + "</td>";
                    str += "<td>" + product.price + "</td>";
                    str += "<td>" + product.instock + "</td>";
                    str += "</tr>";
                });
                str += "</tbody>";
                str += "</table>";
                $("#Products").html(str);
            }).fail(function (error) {
                alert(error.statusText);
            });
        }

        function InsertProducts() {
            var productInsert = {
                title: $("#insertTitle").val(),
                price: $("#insertPrice").val(),
                instock: $("#insertInstock").val(),
            };
            $.ajax({
                type: "post",
                url: "http://localhost:1337/api/products",
                data: productInsert
            }).done(function (data) {
                alert("新增商品成功!")
            }).fail(function (err) {
                alert(err);
            });
        }

        function UpdateProducts() {
            var productUpdate = {
                title: $("#updateTitle").val(),
                price: $("#updatePrice").val(),
                instock: $("#updateInstock").val(),
            };
            $.ajax({
                type: "put",
                url: "http://localhost:1337/api/products",
                data: productUpdate
            }).done(function (data) {
                alert("修改商品成功!")
            }).fail(function (err) {
                alert(err);
            });
        };

        function DeleteProducts() {
            $.ajax({
                type: "delete",
                url: "http://localhost:1337/api/products/" + $("#deleteTitle").val(),
            }).done(function (data) {
                alert("刪除商品成功!")
            }).fail(function (err) {
                alert(err);
            });
        };

    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>

</body>
</html>